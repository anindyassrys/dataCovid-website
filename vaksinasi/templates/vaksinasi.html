{% extends 'base.html' %}
{% load static %}
{% block css %}
<!-- bootstraps css -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<!-- bootstrap js -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
{% endblock css %}

{% block content %}
    <head>
        <title>Vaksinasi</title>
        <link rel="stylesheet" href="{% static 'vaksinasi-style.css' %}">
        <script src="{% static 'jquery-3.6.0.min.js' %}"></script>
        <script>
            $(document).ready(function(){
                getSelectedValue();
            });
            function getSelectedValue(){
                var currentUrl = window.location.href;
                console.log(currentUrl);
                var selectedValue = document.getElementById("kategori").value;
                if (selectedValue == "semua-vaksinasi") {
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(0).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(0).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(0).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(0).fields['telah_vaksin_dosis_1'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(0).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(0).fields['telah_vaksin_dosis_2'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(0).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(0).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(0).fields['telah_vaksin_dosis_1'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(0).fields['telah_vaksin_dosis_1'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + "%");
                            $(".persentase-2").text(((result.at(0).fields['telah_vaksin_dosis_2'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(0).fields['telah_vaksin_dosis_2'] / result.at(0).fields['target_vaksin']) * 100).toFixed(2) + "%");
                    }});
                }else if(selectedValue == "tenaga-kesehatan"){
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(1).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(1).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(1).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(1).fields['telah_vaksin_dosis_1'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(1).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(1).fields['telah_vaksin_dosis_2'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(1).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(1).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(1).fields['telah_vaksin_dosis_1'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(1).fields['telah_vaksin_dosis_1'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + "%");
                            $(".persentase-2").text(((result.at(1).fields['telah_vaksin_dosis_2'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(1).fields['telah_vaksin_dosis_2'] / result.at(1).fields['target_vaksin']) * 100).toFixed(2) + "%");
                    }});
                }else if(selectedValue == "petugas-publik"){
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(2).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(2).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(2).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(2).fields['telah_vaksin_dosis_1'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(2).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(2).fields['telah_vaksin_dosis_2'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(2).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(2).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(2).fields['telah_vaksin_dosis_1'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(2).fields['telah_vaksin_dosis_1'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + "%");
                            $(".persentase-2").text(((result.at(2).fields['telah_vaksin_dosis_2'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(2).fields['telah_vaksin_dosis_2'] / result.at(2).fields['target_vaksin']) * 100).toFixed(2) + "%"); 
                    }});
                }else if(selectedValue == "lanjut-usia"){
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(3).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(3).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(3).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(3).fields['telah_vaksin_dosis_1'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(3).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(3).fields['telah_vaksin_dosis_2'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(3).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(3).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(3).fields['telah_vaksin_dosis_1'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(3).fields['telah_vaksin_dosis_1'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + "%");     
                            $(".persentase-2").text(((result.at(3).fields['telah_vaksin_dosis_2'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(3).fields['telah_vaksin_dosis_2'] / result.at(3).fields['target_vaksin']) * 100).toFixed(2) + "%");        
                    }});                    
                }else if(selectedValue == "masyarakat-rentan-dan-umum"){
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(4).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(4).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(4).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(4).fields['telah_vaksin_dosis_1'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(4).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(4).fields['telah_vaksin_dosis_2'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(4).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(4).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(4).fields['telah_vaksin_dosis_1'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(4).fields['telah_vaksin_dosis_1'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + "%"); 
                            $(".persentase-2").text(((result.at(4).fields['telah_vaksin_dosis_2'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(4).fields['telah_vaksin_dosis_2'] / result.at(4).fields['target_vaksin']) * 100).toFixed(2) + "%"); 
                    }});  
                }else if(selectedValue == "kelompok-usia-12-17-tahun"){
                    $.ajax({
                        url: currentUrl + "kategori", 
                        success: function(result){
                            $(".nama-kategori").text(result.at(5).fields['nama_kategori']);
                            $(".dosis-1").text(numberWithSpaces(result.at(5).fields['telah_vaksin_dosis_1']));
                            $(".dosis-2").text(numberWithSpaces(result.at(5).fields['telah_vaksin_dosis_2']));
                            $(".target-vaksin-1").text(((result.at(5).fields['telah_vaksin_dosis_1'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(5).fields['target_vaksin']) + " telah divaksin");
                            $(".target-vaksin-2").text(((result.at(5).fields['telah_vaksin_dosis_2'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + " % dari " + numberWithSpaces(result.at(5).fields['target_vaksin']) + " telah divaksin");
                            $(".per-tanggal").text("Pembaruan terakhir :   " + result.at(5).fields['per_tanggal']);
                            $(".persentase-1").text(((result.at(5).fields['telah_vaksin_dosis_1'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-1").css("width", ((result.at(5).fields['telah_vaksin_dosis_1'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + "%"); 
                            $(".persentase-2").text(((result.at(5).fields['telah_vaksin_dosis_2'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + " %");
                            $(".progress-bar-value-2").css("width", ((result.at(5).fields['telah_vaksin_dosis_2'] / result.at(5).fields['target_vaksin']) * 100).toFixed(2) + "%");
                    }});                     
                }
            }
            function numberWithSpaces(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
            }
        </script>
    </head>
    <div style="margin-left: 25px">
        <br><br><br><br>
    <h1><b>Apa itu vaksin?</b></h1>
    <p>
        Vaksin adalah sediaan biologis yang digunakan untuk menghasilkan kekebalan adaptif terhadap penyakit infeksi tertentu. <br>
        Biasanya, vaksin mengandung agen atau zat yang menyerupai mikroorganisme penyebab penyakit dan sering kali dibuat dari <br> 
        mikroorganisme yang dilemahkan atau dimatikan, dari toksinnya, atau dari salah satu protein permukaannya. Agen dalam vaksin <br>
        merangsang sistem imun agar dapat mengenali agen tersebut sebagai ancaman, menghancurkannya, dan mengingatnya agar sistem imun <br>
        dapat kembali mengenali dan menghancurkan mikroorganisme yang berhubungan dengan agen tersebut saat ditemui pada masa depan.
    </p>
    <h1><b>Mengapa perlu divaksin?</b></h1>
    <p>
        Mengingat akan penyakit Covid-19 yang sedang mewabah saat ini dan telah memakan banyak korban jiwa, vaksinasi mengambil <br> 
        peran penting dalam pembentukan <i>herd immunity</i> di masyarakat. <i>Herd immunity</i> merupakan suatu kondisi ketika <br>
        sebagian besar populasi kebal terhadap penyakit menular tertentu sehingga memberikan perlindungan tidak langsung kepada <br>
        kelompok masyarakat yang tidak kebal terhadap penyakit menular tersebut. Hal ini dapat mengurangi tingkat penularan yang <br>
        kemudian juga mengurangi angka kematian yang terjadi.
    </p>
    <h1><b>Progress vaksinasi per kategori</b></h1>
    <form action="">
        <label for="kategori">Pilih kategori :</label>
        <select name="kategori" id="kategori" onchange="getSelectedValue()">
            <option value="semua-vaksinasi">Semua Vaksinasi</option>
            <option value="tenaga-kesehatan">Tenaga Kesehatan</option>
            <option value="petugas-publik">Petugas Publik</option>
            <option value="lanjut-usia">Lanjut Usia</option>
            <option value="masyarakat-rentan-dan-umum">Masyarakat Rentan dan Umum</option>
            <option value="kelompok-usia-12-17-tahun">Kelompok Usia 12-17 tahun</option>
        </select>
        <br><br>
    </form>
    <div id="main-card">
        <h2 id="card-title">Vaksinasi Dosis 1</h2>
        <h2 id="card-title">Vaksinasi Dosis 2</h2>
        <div id="card-1">
            <h2 class ="nama-kategori"></h2>
            <p class="dosis-1"></p>
            <p class="desc">dosis pertama telah diberikan</p>
            <div class="progress">
                <div class="progress-bar">
                    <div class="progress-bar-value-1"></div>
                </div>
                <div class="progress-persentase">
                    <span class="persentase-1"></span>
                </div>
            </div>
            <p class="target-vaksin-1"></p>
            <p class="per-tanggal"></p>
        </div>
        <div id="card-2">
            <h2 class ="nama-kategori"></h2>
            <p class="dosis-2"></p>
            <p class="desc">dosis kedua telah diberikan</p>
            <div class="progress">
                <div class="progress-bar">
                    <div class="progress-bar-value-2"></div>
                </div>
                <div class="progress-persentase">
                    <span class="persentase-2"></span>
                </div>
            </div>
            <p class="target-vaksin-2"></p>
            <p class="per-tanggal"></p>
        </div>
    </div>
{% endblock %}